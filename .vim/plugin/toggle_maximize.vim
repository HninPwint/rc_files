" ToggleMaximize v1.0

" BUG: Does not restore the originally shape of the layout entirely, e.g.
" windows open on the left of this one tend to remain squashed.

" BUG: It restores the size of the current window, if you have changed to a
" different window, that is the one it will restore.

" BUG: If the user changes the size of the windows after maximizing, the
" script still thinks the toggle is ON, so next time it is used it will
" restore, rather than re-maximize.

" == Options ==
if !exists("g:ToggleMaximizeVertically")
	let g:ToggleMaximizeVertically = 1
endif
if !exists("g:ToggleMaximizeHorizontally")
	let g:ToggleMaximizeHorizontally = 1
endif

let s:isToggledVertically = 0
let s:oldHeight = -1
let s:oldwinheight = -1

function! ToggleMaximizeVertically()
	if s:isToggledVertically == 0
		let s:oldHeight = winheight(0)
		let s:oldwinheight = &winheight
		exec "set winheight=9999"
		let s:isToggledVertically = 1
	else
		exec "set winheight=".s:oldwinheight
		exec "resize ".s:oldHeight
		let s:isToggledVertically = 0
	endif
endfunction

let s:isToggledHorizontally = 0
let s:oldWidth = -1
let s:oldwinwidth = -1

function! ToggleMaximizeHorizontally()
	if s:isToggledHorizontally == 0
		let s:oldWidth = winwidth(0)
		let s:oldwinwidth = &winwidth
		exec "set winwidth=9999"
		let s:isToggledHorizontally = 1
	else
		exec "set winwidth=".s:oldwinwidth
		exec "vertical resize ".s:oldWidth
		let s:isToggledHorizontally = 0
	endif
endfunction

function! ToggleMaximize()
	if g:ToggleMaximizeVertically
		call ToggleMaximizeVertically()
	endif
	if g:ToggleMaximizeHorizontally
		call ToggleMaximizeHorizontally()
	endif
endfunction

" == Keymaps ==

noremap <C-F> :call ToggleMaximize()<Enter>
inoremap <C-F> <Esc>:call ToggleMaximize()<Enter>a
noremap <C-\> :call ToggleMaximize()<Enter>
inoremap <C-\> <Esc>:call ToggleMaximize()<Enter>a
" noremap <C-G> :call ToggleMaximize()<Enter>
" inoremap <C-G> <Esc>:call ToggleMaximize()<Enter>a
" noremap <C-Z> :call ToggleMaximize()<Enter>
" inoremap <C-Z> <Esc>:call ToggleMaximize()<Enter>a

noremap <C-V> :call ToggleMaximizeVertically()<Enter>
inoremap <C-V> <Esc>:call ToggleMaximizeVertically()<Enter>a
noremap <C-H> :call ToggleMaximizeHorizontally()<Enter>
inoremap <C-H> <Esc>:call ToggleMaximizeHorizontally()<Enter>a

"" Does not work:
" noremap <C-Enter> :call ToggleMaximize()<Enter>

